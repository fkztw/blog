<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Just for noting - srt</title><link href="https://blog.fkz.tw/" rel="alternate"></link><link href="https://blog.fkz.tw/feeds/tag.srt.atom.xml" rel="self"></link><id>https://blog.fkz.tw/</id><updated>2018-06-24T21:35:23+08:00</updated><subtitle></subtitle><entry><title>Embed .srt subtitle into .mkv with ffmpeg</title><link href="https://blog.fkz.tw/posts/2018/06/24/embed-srt-subtitle-into-mkv-with-ffmpeg/" rel="alternate"></link><published>2018-06-24T21:35:23+08:00</published><updated>2018-06-24T21:35:23+08:00</updated><author><name>fkz</name></author><id>tag:blog.fkz.tw,2018-06-24:/posts/2018/06/24/embed-srt-subtitle-into-mkv-with-ffmpeg/</id><summary type="html">&lt;p&gt;Note for how to embed .srt subtitle into .mkv video file.&lt;/p&gt;</summary><content type="html">&lt;h2&gt;TL;DR&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ffmpeg -i &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;MKV_FILE_PATH&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; -vf &lt;span class="s2"&gt;&amp;quot;subtitles=&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;SRT_FILE_PATH&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#39;&amp;quot;&lt;/span&gt; &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;OUTPUT_FILE_PATH&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;CAUTION&lt;/h2&gt;
&lt;p&gt;Your &lt;code&gt;ffmpeg&lt;/code&gt; need &lt;code&gt;--enable-libass&lt;/code&gt; configuration.
Use &lt;code&gt;ffmpeg&lt;/code&gt; to check the output, it should be like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;ffmpeg&lt;/span&gt; &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="mf"&gt;4.0.1&lt;/span&gt; &lt;span class="n"&gt;Copyright&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="mi"&gt;2000&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2018&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;FFmpeg&lt;/span&gt; &lt;span class="n"&gt;developers&lt;/span&gt;
  &lt;span class="n"&gt;built&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;Apple&lt;/span&gt; &lt;span class="n"&gt;LLVM&lt;/span&gt; &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="mf"&gt;9.1.0&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clang&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;902.0.39.1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="nl"&gt;configuration&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="o"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Cellar&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ffmpeg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;4.0.1&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;shared&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;pthreads&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;version3&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;hardcoded&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;tables&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;avresample&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;cc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;clang&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;cflags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ldflags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;gpl&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;libass&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;libmp3lame&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;libtheora&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;libvorbis&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;libvpx&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;libx264&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;libxvid&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;opencl&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;videotoolbox&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;openssl&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;disable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;lzma&lt;/span&gt;
&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;nonfree&lt;/span&gt;
  &lt;span class="n"&gt;libavutil&lt;/span&gt;      &lt;span class="mf"&gt;56.&lt;/span&gt; &lt;span class="mf"&gt;14.100&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;56.&lt;/span&gt; &lt;span class="mf"&gt;14.100&lt;/span&gt;
  &lt;span class="n"&gt;libavcodec&lt;/span&gt;     &lt;span class="mf"&gt;58.&lt;/span&gt; &lt;span class="mf"&gt;18.100&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;58.&lt;/span&gt; &lt;span class="mf"&gt;18.100&lt;/span&gt;
  &lt;span class="n"&gt;libavformat&lt;/span&gt;    &lt;span class="mf"&gt;58.&lt;/span&gt; &lt;span class="mf"&gt;12.100&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;58.&lt;/span&gt; &lt;span class="mf"&gt;12.100&lt;/span&gt;
  &lt;span class="n"&gt;libavdevice&lt;/span&gt;    &lt;span class="mf"&gt;58.&lt;/span&gt;  &lt;span class="mf"&gt;3.100&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;58.&lt;/span&gt;  &lt;span class="mf"&gt;3.100&lt;/span&gt;
  &lt;span class="n"&gt;libavfilter&lt;/span&gt;     &lt;span class="mf"&gt;7.&lt;/span&gt; &lt;span class="mf"&gt;16.100&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;  &lt;span class="mf"&gt;7.&lt;/span&gt; &lt;span class="mf"&gt;16.100&lt;/span&gt;
  &lt;span class="n"&gt;libavresample&lt;/span&gt;   &lt;span class="mf"&gt;4.&lt;/span&gt;  &lt;span class="mf"&gt;0.&lt;/span&gt;  &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;  &lt;span class="mf"&gt;4.&lt;/span&gt;  &lt;span class="mf"&gt;0.&lt;/span&gt;  &lt;span class="mi"&gt;0&lt;/span&gt;
  &lt;span class="n"&gt;libswscale&lt;/span&gt;      &lt;span class="mf"&gt;5.&lt;/span&gt;  &lt;span class="mf"&gt;1.100&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;  &lt;span class="mf"&gt;5.&lt;/span&gt;  &lt;span class="mf"&gt;1.100&lt;/span&gt;
  &lt;span class="n"&gt;libswresample&lt;/span&gt;   &lt;span class="mf"&gt;3.&lt;/span&gt;  &lt;span class="mf"&gt;1.100&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;  &lt;span class="mf"&gt;3.&lt;/span&gt;  &lt;span class="mf"&gt;1.100&lt;/span&gt;
  &lt;span class="n"&gt;libpostproc&lt;/span&gt;    &lt;span class="mf"&gt;55.&lt;/span&gt;  &lt;span class="mf"&gt;1.100&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;55.&lt;/span&gt;  &lt;span class="mf"&gt;1.100&lt;/span&gt;
&lt;span class="n"&gt;Hyper&lt;/span&gt; &lt;span class="n"&gt;fast&lt;/span&gt; &lt;span class="n"&gt;Audio&lt;/span&gt; &lt;span class="n"&gt;and&lt;/span&gt; &lt;span class="n"&gt;Video&lt;/span&gt; &lt;span class="n"&gt;encoder&lt;/span&gt;
&lt;span class="nl"&gt;usage&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ffmpeg&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;infile&lt;/span&gt; &lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;infile&lt;/span&gt;&lt;span class="p"&gt;]...&lt;/span&gt; &lt;span class="p"&gt;{[&lt;/span&gt;&lt;span class="n"&gt;outfile&lt;/span&gt; &lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;outfile&lt;/span&gt;&lt;span class="p"&gt;}...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If you see &lt;code&gt;--enable-libass&lt;/code&gt; in the output, you don't have to do anything.&lt;/p&gt;
&lt;p&gt;Otherwise, you have to reinstall your &lt;code&gt;ffmpeg&lt;/code&gt; with &lt;code&gt;--enable-libass&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;If you are using macOS with &lt;code&gt;homebrew&lt;/code&gt;, you can do it by the command below:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;brew install ffmpeg --with-libass
&lt;/pre&gt;&lt;/div&gt;


&lt;hr&gt;
&lt;h2&gt;Preface&lt;/h2&gt;
&lt;p&gt;I have one .mkv and one .srt file, and I want to play it on my Chromecast with subtitles.&lt;/p&gt;
&lt;p&gt;Unfortunately, Chromecast doesn't support adding subtitle track while playing.&lt;/p&gt;
&lt;p&gt;So, I came up with embedding subtitles into video files with &lt;code&gt;ffmpeg&lt;/code&gt;.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Note&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;ffmpeg -i ${MKV_FILE_PATH} -vf "subtitles='${SRT_FILE_PATH}'" ${OUTPUT_FILE_PATH}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;(With &lt;code&gt;--enable-libass&lt;/code&gt; ffmpeg)&lt;/p&gt;
&lt;p&gt;If the font size of the embedded subtitles is too small. You can also change the font size with &lt;code&gt;force_style&lt;/code&gt; option (even change the font and the color):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ffmpeg -i &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;MKV_FILE_PATH&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; -vf &lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="s2"&gt;&amp;quot;subtitles=&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;SRT_FILE_PATH&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#39;:force_style=&amp;#39;FontName=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;FONT_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;,FontSize=24,PrimaryColour=&amp;amp;HAA00FF00&amp;#39;&amp;quot;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;OUTPUT_FILE_PATH&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;hr&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://gist.github.com/clayton/6196167"&gt;Install FFMPEG on OS X with HomeBrew to convert Mp4 to WebM&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.mobile01.com/topicdetail.php?f=510&amp;amp;t=4462836"&gt;[FFmpeg] 烙印字幕至影像上 (Hardsub)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="CLI"></category><category term="ffmpeg"></category><category term="srt"></category><category term="mkv"></category></entry></feed>